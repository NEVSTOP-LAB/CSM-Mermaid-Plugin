<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <style>
      .mermaid-container {
        overflow: auto;
        width: 100%;
        height: 100vh;
        position: relative;
      }
      .mermaid {
        transform-origin: top left;
        transition: transform 0.1s ease;
      }
      .scale-indicator {
        display: block;
        background-color: rgba(255, 255, 255, 0.9);
        border: 1px solid #ccc;
        padding: 5px 10px;
        border-radius: 4px;
        font-family: Arial, sans-serif;
        font-size: 14px;
        margin-bottom: 10px;
        width: fit-content;
      }
    </style>
  </head>
  <body>

    <div class="scale-indicator" id="scaleIndicator">缩放: 100%</div>
    <div class="mermaid-container">
      <pre class="mermaid">
%s
      </pre>
    </div>

    <script src="js/mermaid.min.js"></script>
    <script>
      // 初始化缩放因子
      let scale = 1;
      const scaleStep = 0.1;
      const container = document.querySelector('.mermaid-container');
      const mermaidElement = document.querySelector('.mermaid');
      const scaleIndicator = document.getElementById('scaleIndicator');
      
      // 更新缩放比例显示
      function updateScaleIndicator() {
        const percentage = Math.round(scale * 100);
        scaleIndicator.textContent = `缩放: ${percentage}%`;
      }
      
      // 设置 mermaid 配置
      mermaid.initialize({
        startOnLoad: true,
        theme: 'default'
      });
      
      // 添加鼠标滚轮缩放事件
      container.addEventListener('wheel', function(e) {
        e.preventDefault();
        
        // 计算新的缩放因子
        if (e.deltaY < 0) {
          // 向上滚动，放大
          scale += scaleStep;
        } else {
          // 向下滚动，缩小
          scale = Math.max(0.1, scale - scaleStep); // 最小缩放到 0.1
        }
        
        // 应用缩放
        mermaidElement.style.transform = `scale(${scale})`;
        updateScaleIndicator();

      });
      
      // 双击重置缩放
      container.addEventListener('dblclick', function() {
        scale = 1;
        mermaidElement.style.transform = `scale(${scale})`;
        updateScaleIndicator();
      });
      
      // 等待 mermaid 渲染完成后再应用缩放
      document.addEventListener('DOMContentLoaded', function() {
        setTimeout(function() {
          // 确保 mermaid 已经渲染完成
          if (mermaidElement) {
            mermaidElement.style.transform = `scale(${scale})`;
          }
        }, 100);
      });
    </script>

  </body>
</html>